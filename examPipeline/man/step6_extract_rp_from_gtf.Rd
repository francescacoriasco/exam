% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step6_extract_rp_from_gtf.R
\name{step6_extract_rp_from_gtf}
\alias{step6_extract_rp_from_gtf}
\title{Step 6 â€” Extract ribosomal protein (RP) genes from an Ensembl GTF and write RP-only GTF}
\usage{
step6_extract_rp_from_gtf(
  refs_dir,
  gtf_url = NULL,
  species = "homo_sapiens",
  assembly = "GRCh38",
  release = 115L,
  gtf_gz = NULL,
  rp_prefix = "RP",
  rp_ids_rds = NULL,
  gtf_rp_gz = NULL,
  download_if_missing = TRUE,
  chunk = 20000L,
  verbose = TRUE
)
}
\arguments{
\item{refs_dir}{Output/reference directory.}

\item{gtf_url}{Optional explicit URL. If NULL, it is constructed from \code{species}, \code{assembly}, \code{release}.}

\item{species}{Ensembl species folder (default \code{"homo_sapiens"}).}

\item{assembly}{Assembly string used in filename (default \code{"GRCh38"}).}

\item{release}{Ensembl release integer (default 115).}

\item{gtf_gz}{Optional local path to full GTF (.gtf.gz). If NULL, uses \code{refs_dir}.}

\item{rp_prefix}{Prefix for \code{gene_name} to define RP genes (default \code{"RP"}).}

\item{rp_ids_rds}{Path to save RP gene_ids RDS (default in \code{refs_dir}).}

\item{gtf_rp_gz}{Path to write RP-only GTF (default in \code{refs_dir}).}

\item{download_if_missing}{If TRUE, downloads full GTF if not found.}

\item{chunk}{Number of lines to read per chunk (streaming; low RAM).}

\item{verbose}{If TRUE, prints progress.}
}
\value{
Invisible list with \code{rp_gene_ids}, \code{gtf_gz}, \code{rp_ids_rds}, \code{gtf_rp_gz}.
}
\description{
Downloads (optionally) an Ensembl GTF, extracts gene_ids for genes whose gene_name starts
with \code{rp_prefix} (default \code{"RP"}), saves the gene_id list to RDS, and writes a
filtered RP-only GTF (\code{.gtf.gz}).
}
