% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step4_subsample_scrna_to_seurat.R
\name{step4_subsample_scrna_to_seurat}
\alias{step4_subsample_scrna_to_seurat}
\title{Step 4 â€” Subsample scRNA-seq cells reproducibly and build Seurat objects}
\usage{
step4_subsample_scrna_to_seurat(
  scrna_files,
  sample_n = 500L,
  seed = 1L,
  bpparam = BiocParallel::SerialParam(),
  rna_types = c("Gene Expression", "RNA"),
  prefix_cells = TRUE,
  sample_id_fun = function(path) tools::file_path_sans_ext(basename(path)),
  verbose = TRUE
)
}
\arguments{
\item{scrna_files}{Character vector of \code{.h5} paths (typically output of Step 3).}

\item{sample_n}{Number of cells per dataset (keeps all if fewer).}

\item{seed}{Random seed for reproducible sampling.}

\item{bpparam}{\code{BiocParallelParam} for \code{DropletUtils::read10xCounts()}.}

\item{rna_types}{Feature types treated as scRNA.}

\item{prefix_cells}{If TRUE, prefixes cell IDs with sample_id to avoid collisions.}

\item{sample_id_fun}{Function mapping file path -> sample ID.}

\item{verbose}{If TRUE, prints progress.}
}
\value{
Named list of Seurat objects.
}
\description{
For each scRNA \code{.h5} file, reads counts, keeps only \dQuote{Gene Expression}/\dQuote{RNA}
features when annotated, subsamples \code{sample_n} cells reproducibly, and returns one
Seurat object per dataset.
}
